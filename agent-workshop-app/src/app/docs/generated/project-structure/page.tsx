'use client';

import { DocsLayout } from '@/components/docs/DocsLayout';
import { CodeBlock } from '@/components/docs/CodeBlock';
import { Callout } from '@/components/docs/Callout';

export default function ProjectStructurePage() {
  return (
    <DocsLayout
      title="Project Structure"
      description="Understanding the files generated by Agent Workshop."
    >
      <p>
        When you download your agent from Agent Workshop, you receive a complete
        TypeScript project ready to build and run. This guide explains each file
        and directory.
      </p>

      <h2>Directory Overview</h2>

      <CodeBlock
        language="bash"
        code={`my-agent/
├── package.json          # Dependencies and npm scripts
├── tsconfig.json         # TypeScript configuration
├── src/
│   ├── cli.ts           # CLI entry point
│   ├── agent.ts         # Core agent logic
│   ├── config.ts        # Configuration management
│   ├── permissions.ts   # Permission system
│   ├── mcp-config.ts    # MCP server management
│   ├── planner.ts       # Planning mode support
│   └── workflows.ts     # Workflow executor
├── .claude/
│   ├── CLAUDE.md        # Agent memory
│   ├── commands/        # Slash commands
│   ├── agents/          # Subagent definitions
│   ├── skills/          # Skill definitions
│   └── settings.json    # Hooks configuration
├── .commands/           # Domain workflow definitions
├── .plans/              # Plan storage directory
├── .mcp.json            # MCP server configuration
├── .env.example         # Environment template
├── .gitignore           # Git ignore rules
├── README.md            # Project documentation
├── LICENSE              # License file
└── scripts/
    └── publish.sh       # NPM publish script`}
      />

      <h2>Core Files</h2>

      <h3>package.json</h3>
      <p>
        NPM package configuration with dependencies and scripts.
      </p>
      <CodeBlock
        language="json"
        code={`{
  "name": "my-agent",
  "version": "1.0.0",
  "type": "module",
  "main": "dist/cli.js",
  "bin": {
    "my-agent": "dist/cli.js"
  },
  "scripts": {
    "build": "tsc",
    "dev": "tsc --watch",
    "start": "node dist/cli.js"
  },
  "dependencies": {
    "@anthropic-ai/claude-code": "^0.1.53",
    "commander": "^11.1.0",
    "chalk": "^5.3.0",
    "ora": "^8.0.1",
    "inquirer": "^9.2.12",
    "dotenv": "^16.3.1"
  }
}`}
      />

      <h3>src/cli.ts</h3>
      <p>
        The CLI entry point. Handles command-line arguments, interactive mode,
        and user input.
      </p>
      <ul>
        <li>Parses command-line arguments with Commander</li>
        <li>Manages interactive prompt loop</li>
        <li>Handles slash commands and special inputs</li>
        <li>Displays streaming responses</li>
      </ul>

      <h3>src/agent.ts</h3>
      <p>
        Core agent implementation. Defines the agent class with all configured tools.
      </p>
      <ul>
        <li>Agent initialization and configuration</li>
        <li>Tool definitions and implementations</li>
        <li>Message handling and response streaming</li>
        <li>Session management</li>
      </ul>

      <h3>src/config.ts</h3>
      <p>
        Configuration management. Loads and validates environment variables and settings.
      </p>
      <ul>
        <li>Environment variable loading</li>
        <li>API key validation</li>
        <li>Default value management</li>
      </ul>

      <h3>src/permissions.ts</h3>
      <p>
        Permission system implementation. Controls what tools can do based on permission level.
      </p>
      <ul>
        <li>Permission policies (restrictive, balanced, permissive)</li>
        <li>Path restrictions</li>
        <li>Command filtering</li>
        <li>User confirmation prompts</li>
      </ul>

      <h3>src/mcp-config.ts</h3>
      <p>
        MCP server management. Loads and connects to configured MCP servers.
      </p>
      <ul>
        <li>Server configuration loading from .mcp.json</li>
        <li>Transport handling (stdio, http, sse, sdk)</li>
        <li>Environment variable resolution</li>
      </ul>

      <h3>src/planner.ts</h3>
      <p>
        Planning mode support. Manages plan creation, storage, and execution.
      </p>
      <ul>
        <li>Plan file management in .plans/</li>
        <li>Plan listing and status</li>
        <li>Plan execution tracking</li>
      </ul>

      <h3>src/workflows.ts</h3>
      <p>
        Workflow executor. Runs domain-specific multi-step workflows.
      </p>
      <ul>
        <li>Workflow loading from .commands/</li>
        <li>Step-by-step execution</li>
        <li>Progress tracking</li>
      </ul>

      <h2>.claude/ Directory</h2>
      <p>
        Contains Claude Code-style lever configurations.
      </p>

      <h3>CLAUDE.md</h3>
      <p>
        Agent memory file. Loaded at the start of every conversation to provide
        persistent context.
      </p>

      <h3>commands/</h3>
      <p>
        Slash command definitions. Each <code>.md</code> file is a command template.
      </p>

      <h3>agents/</h3>
      <p>
        Subagent definitions. Each <code>.md</code> file defines a specialized subagent.
      </p>

      <h3>skills/</h3>
      <p>
        Skill definitions. Each subdirectory contains a <code>SKILL.md</code> file.
      </p>

      <h3>settings.json</h3>
      <p>
        Hooks configuration. Defines event-driven automations.
      </p>

      <h2>.commands/ Directory</h2>
      <p>
        Domain-specific workflow definitions. JSON files that define multi-step
        workflows for common tasks.
      </p>

      <CodeBlock
        language="json"
        filename=".commands/code-audit.json"
        code={`{
  "name": "code-audit",
  "description": "Perform a comprehensive code audit",
  "steps": [
    {
      "name": "scan",
      "prompt": "Scan the codebase for security vulnerabilities"
    },
    {
      "name": "analyze",
      "prompt": "Analyze code quality and patterns"
    },
    {
      "name": "report",
      "prompt": "Generate audit report with findings"
    }
  ]
}`}
      />

      <h2>Configuration Files</h2>

      <h3>.mcp.json</h3>
      <p>
        MCP server configuration. Defines which MCP servers to connect to.
      </p>

      <h3>.env.example</h3>
      <p>
        Environment variable template. Copy to <code>.env</code> and fill in values.
      </p>
      <CodeBlock
        language="bash"
        code={`# API Keys
ANTHROPIC_API_KEY=your-key-here
# or
OPENAI_API_KEY=your-key-here

# Optional: MCP Server credentials
GITHUB_TOKEN=
DATABASE_URL=`}
      />

      <h3>tsconfig.json</h3>
      <p>
        TypeScript configuration. Targets ES2022 with module resolution for Node.
      </p>

      <Callout type="tip" title="Customization">
        <p>
          All generated files are meant to be customized. The structure provides
          a solid foundation, but you can modify any file to fit your needs.
        </p>
      </Callout>
    </DocsLayout>
  );
}
